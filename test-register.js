// Test script to register users on server
const http = require('http');

const testUsers = ['alice', 'bob', 'charlie', 'david', 'eve'];

function registerUser(username) {
    return new Promise((resolve, reject) => {
        const data = JSON.stringify({ username: username });
        
        const options = {
            hostname: 'localhost',
            port: 3000,
            path: '/api/register',
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Content-Length': data.length
            }
        };
        
        const req = http.request(options, (res) => {
            let body = '';
            
            res.on('data', (chunk) => {
                body += chunk;
            });
            
            res.on('end', () => {
                try {
                    const response = JSON.parse(body);
                    if (response.success) {
                        console.log(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω`);
                        resolve(response);
                    } else {
                        console.log(`‚ö†Ô∏è ${username}: ${response.error}`);
                        resolve(response);
                    }
                } catch (error) {
                    console.error(`‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞ –¥–ª—è ${username}:`, error);
                    reject(error);
                }
            });
        });
        
        req.on('error', (error) => {
            console.error(`‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ${username}:`, error);
            reject(error);
        });
        
        req.write(data);
        req.end();
    });
}

async function registerAllUsers() {
    console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...\n');
    
    for (const username of testUsers) {
        await registerUser(username);
        await new Promise(resolve => setTimeout(resolve, 100)); // Small delay
    }
    
    console.log('\n‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
    console.log('\n–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –ø–æ–¥ –ª—é–±—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:');
    testUsers.forEach(user => console.log(`  - ${user}`));
    console.log('\n(–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ)');
}

registerAllUsers().catch(error => {
    console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', error);
    process.exit(1);
});
